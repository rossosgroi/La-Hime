{% comment %}
  Collection Template - La Hime Shop Page
  Clean collections page with filtering and sorting
{% endcomment %}

<div class="pt-24 pb-24 min-h-screen bg-stone-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    
    {%- comment -%} Header Section {%- endcomment -%}
    <div class="mb-12">
      <p class="text-gray-500 text-sm font-medium mb-4">Find your new obsession.</p>
    </div>

    {%- comment -%} Filters & Sorting {%- endcomment -%}
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-12 pb-6 border-b border-gray-200">
      
      {%- comment -%} Filter Tags {%- endcomment -%}
      <div class="w-full md:w-auto overflow-x-auto">
        <div class="flex items-center gap-3 whitespace-nowrap">
          <a href="{{ collection.url }}" class="px-5 py-2 rounded-full text-sm font-bold transition-all duration-300 border {% if current_tags.size == 0 %}bg-black text-white border-black{% else %}bg-white text-gray-600 border-gray-300 hover:border-pink-500 hover:text-pink-600{% endif %}">
            All
          </a>
          {% for tag in collection.all_tags %}
            {% unless tag contains '_' %}
              <a href="{{ collection.url }}/{{ tag | handle }}" class="px-5 py-2 rounded-full text-sm font-bold transition-all duration-300 border {% if current_tags contains tag %}bg-black text-white border-black{% else %}bg-white text-gray-600 border-gray-300 hover:border-pink-500 hover:text-pink-600{% endif %}">
                {{ tag }}
              </a>
            {% endunless %}
          {% endfor %}
        </div>
      </div>

      {%- comment -%} Sort Dropdown {%- endcomment -%}
      <div class="flex items-center gap-4">
        <span class="text-sm text-gray-500 font-medium">{{ collection.products.size }} items</span>
        <select id="SortBy" class="appearance-none bg-white border border-gray-300 rounded-lg px-4 py-2 text-sm font-bold text-gray-900 cursor-pointer hover:border-gray-400 focus:outline-none focus:border-pink-500" onchange="window.location.href = this.value">
          <option value="{{ collection.url }}?sort_by=manual">Featured</option>
          <option value="{{ collection.url }}?sort_by=best-selling">Best Selling</option>
          <option value="{{ collection.url }}?sort_by=title-ascending">A-Z</option>
          <option value="{{ collection.url }}?sort_by=title-descending">Z-A</option>
          <option value="{{ collection.url }}?sort_by=price-ascending">Price: Low to High</option>
          <option value="{{ collection.url }}?sort_by=price-descending">Price: High to Low</option>
          <option value="{{ collection.url }}?sort_by=created-descending">Newest</option>
        </select>
      </div>
    </div>

    {%- comment -%} Products Grid {%- endcomment -%}
    <div class="min-h-[400px]">
      {% paginate collection.products by 12 %}
        {% if collection.products.size > 0 %}
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-12">
            {% for product in collection.products %}
              {% render 'product-card', product: product %}
            {% endfor %}
          </div>

          {%- comment -%} Pagination {%- endcomment -%}
          {% if paginate.pages > 1 %}
            <div class="mt-16 flex justify-center items-center gap-2">
              {% if paginate.previous %}
                <a href="{{ paginate.previous.url }}" class="px-4 py-2 rounded-full border border-gray-300 text-gray-900 hover:bg-black hover:text-white transition-all font-bold">
                  ← Previous
                </a>
              {% endif %}
              
              {% for part in paginate.parts %}
                {% if part.is_link %}
                  <a href="{{ part.url }}" class="w-10 h-10 flex items-center justify-center rounded-full border border-gray-300 text-gray-900 hover:bg-black hover:text-white transition-all font-bold">
                    {{ part.title }}
                  </a>
                {% else %}
                  <span class="w-10 h-10 flex items-center justify-center rounded-full bg-black text-white font-bold">
                    {{ part.title }}
                  </span>
                {% endif %}
              {% endfor %}
              
              {% if paginate.next %}
                <a href="{{ paginate.next.url }}" class="px-4 py-2 rounded-full border border-gray-300 text-gray-900 hover:bg-black hover:text-white transition-all font-bold">
                  Next →
                </a>
              {% endif %}
            </div>
          {% endif %}
        {% else %}
          <div class="text-center py-24 text-gray-400 flex flex-col items-center">
            <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="4" y1="21" x2="4" y2="14"></line>
                <line x1="4" y1="10" x2="4" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12" y2="3"></line>
                <line x1="20" y1="21" x2="20" y2="16"></line>
                <line x1="20" y1="12" x2="20" y2="3"></line>
                <line x1="1" y1="14" x2="7" y2="14"></line>
                <line x1="9" y1="8" x2="15" y2="8"></line>
                <line x1="17" y1="16" x2="23" y2="16"></line>
              </svg>
            </div>
            <p class="text-xl font-serif-display text-gray-900 mb-2">No items found</p>
            <p class="text-sm text-gray-500 mb-6">Try adjusting your filters or search.</p>
            <a href="/collections/all" class="text-pink-600 font-bold underline hover:text-black transition-colors">
              View All Products
            </a>
          </div>
        {% endif %}
      {% endpaginate %}
    </div>
  </div>
</div>
