{% comment %}
  Cart Template - Full Shopping Cart Page
  Mirrors La Hime React Cart.tsx functionality
{% endcomment %}

<div class="pt-32 pb-24 min-h-screen bg-stone-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <h1 class="font-serif-display text-4xl mb-8 text-gray-900">Shopping Bag</h1>

    {% if cart.item_count == 0 %}
      {%- comment -%} Empty Cart State {%- endcomment -%}
      <div class="text-center py-20 bg-white rounded-2xl shadow-sm">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">Your bag is empty</h2>
        <p class="text-gray-500 mb-8">Looks like you haven't added anything yet.</p>
        <a 
          href="/collections/all" 
          class="inline-block bg-black text-white px-8 py-3 rounded-full font-bold uppercase tracking-wider hover:bg-pink-500 transition-colors"
        >
          Start Shopping
        </a>
      </div>
    {% else %}
      {%- comment -%} Cart with Items {%- endcomment -%}
      <div class="flex flex-col lg:flex-row gap-12">
        
        {%- comment -%} Cart Items List {%- endcomment -%}
        <div class="flex-1 space-y-6">
          {% for item in cart.items %}
            <div class="bg-white p-6 rounded-2xl shadow-sm flex gap-6 items-center group hover:shadow-lg transition-shadow duration-300">
              
              {%- comment -%} Product Image {%- endcomment -%}
              <a href="{{ item.url }}" class="w-24 h-24 flex-shrink-0 bg-gray-100 rounded-lg overflow-hidden block">
                <img 
                  src="{{ item.image | image_url: width: 100, height: 100 }}" 
                  alt="{{ item.title }}" 
                  class="w-full h-full object-cover hover:scale-110 transition-transform duration-500"
                  loading="lazy"
                />
              </a>

              {%- comment -%} Item Details {%- endcomment -%}
              <div class="flex-1">
                <div class="flex justify-between items-start mb-2">
                  <a href="{{ item.url }}" class="flex-1">
                    <h3 class="font-bold text-gray-900 font-serif-display text-lg hover:text-pink-600 transition-colors">
                      {{ item.title }}
                    </h3>
                  </a>
                  <p class="font-mono font-medium text-gray-900">
                    {{ item.final_line_price | money }}
                  </p>
                </div>

                {%- comment -%} Size/Variant {%- endcomment -%}
                {% if item.variant.title != "Default Title" %}
                  <p class="text-sm text-gray-500 mb-4">{{ item.variant.title }}</p>
                {% endif %}

                {%- comment -%} Quantity & Remove {%- endcomment -%}
                <div class="flex justify-between items-center">
                  <div class="flex items-center border border-gray-200 rounded-full">
                    <a 
                      href="{{ item.url }}?quantity={{ item.quantity | minus: 1 }}" 
                      class="p-2 hover:bg-gray-50 rounded-full transition-colors text-gray-600"
                      {% if item.quantity == 1 %}onclick="return confirm('Remove this item?');"{% endif %}
                    >
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                      </svg>
                    </a>
                    <span class="w-8 text-center text-sm font-bold text-gray-900">{{ item.quantity }}</span>
                    <a 
                      href="{{ item.url }}?quantity={{ item.quantity | plus: 1 }}" 
                      class="p-2 hover:bg-gray-50 rounded-full transition-colors text-gray-600"
                    >
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                      </svg>
                    </a>
                  </div>
                  
                  {%- comment -%} Remove Item {%- endcomment -%}
                  <form action="/cart/change" method="post" class="inline">
                    <input type="hidden" name="id" value="{{ item.key }}">
                    <input type="hidden" name="quantity" value="0">
                    <button 
                      type="submit" 
                      class="text-gray-400 hover:text-red-500 transition-colors"
                      title="Remove item"
                    >
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        <line x1="10" y1="11" x2="10" y2="17"></line>
                        <line x1="14" y1="11" x2="14" y2="17"></line>
                      </svg>
                    </button>
                  </form>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>

        {%- comment -%} Order Summary Sidebar {%- endcomment -%}
        <div class="w-full lg:w-96">
          <div class="bg-white p-8 rounded-2xl shadow-sm sticky top-32 space-y-6">
            <h2 class="font-bold text-xl text-gray-900">Order Summary</h2>

            {%- comment -%} Subtotal {%- endcomment -%}
            <div class="space-y-4 border-b border-gray-100 pb-4">
              <div class="flex justify-between text-gray-600">
                <span>Subtotal</span>
                <span>{{ cart.subtotal_price | money }}</span>
              </div>

              {%- comment -%} Shipping Calculator {%- endcomment -%}
              <div class="pt-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Estimated Shipping</label>
                {% if cart.requires_shipping %}
                  <details class="text-sm text-gray-500 cursor-pointer group">
                    <summary class="hover:text-gray-900 transition-colors">
                      Free shipping on orders over $150 â€” {{ cart.shipping_policy_url | link_to: "View Policy", class: "underline hover:text-pink-500" }}
                    </summary>
                    <div class="mt-2 p-3 bg-gray-50 rounded-lg text-xs">
                      <p>Shipping cost will be calculated at checkout based on your location.</p>
                    </div>
                  </details>
                {% else %}
                  <p class="text-sm text-green-600 font-medium">Free (Digital)</p>
                {% endif %}
              </div>
            </div>

            {%- comment -%} Taxes Note {%- endcomment -%}
            <p class="text-xs text-gray-400">Taxes calculated at checkout</p>

            {%- comment -%} Total {%- endcomment -%}
            <div class="flex justify-between items-center pt-4">
              <span class="text-lg font-bold text-gray-900">Total</span>
              <span class="text-2xl font-bold text-gray-900">{{ cart.total_price | money }}</span>
            </div>

            {%- comment -%} Checkout Button {%- endcomment -%}
            <form action="/checkout" method="post" class="w-full">
              <button 
                type="submit" 
                class="w-full bg-black text-white py-4 rounded-full font-bold uppercase tracking-wider hover:bg-pink-500 transition-colors shadow-lg hover:shadow-pink-500/40 transform hover:-translate-y-1 duration-300"
              >
                Proceed to Checkout
              </button>
            </form>

            {%- comment -%} Continue Shopping {%- endcomment -%}
            <a 
              href="/collections/all" 
              class="block w-full text-center py-3 border border-gray-200 rounded-full font-bold text-gray-900 hover:border-gray-900 transition-colors"
            >
              Continue Shopping
            </a>

            {%- comment -%} Trust Badges {%- endcomment -%}
            <div class="pt-4 space-y-3 border-t border-gray-100 text-xs text-gray-500">
              <div class="flex items-center gap-2">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="text-green-600">
                  <path d="M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 16l-4-4 1.41-1.41L10 12.17l6.59-6.59L18 7l-8 9z"/>
                </svg>
                Secure checkout powered by Shopify
              </div>
              <div class="flex items-center gap-2">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="text-blue-600">
                  <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/>
                </svg>
                30-day money-back guarantee
              </div>
              <div class="flex items-center gap-2">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="text-pink-500">
                  <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                </svg>
                Wishlist your favorites
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endif %}
  </div>
</div>

<style>
  .font-brand {
    font-family: 'Pacifico', cursive;
  }
  
  .font-serif-display {
    font-family: 'Playfair Display', serif;
  }

  @media (max-width: 1024px) {
    .sticky {
      position: static;
    }
  }
</style>

{% schema %}
{
  "name": "Cart Page",
  "description": "Full shopping cart page with order summary"
}
{% endschema %}
